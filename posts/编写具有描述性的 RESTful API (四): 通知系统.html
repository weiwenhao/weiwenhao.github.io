<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 编写具有描述性的 RESTful API (四): 通知系统 · weiwenhao</title><meta name="description" content="编写具有描述性的 RESTful API (四): 通知系统 - 粤ICP备18153286"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://beian.miit.gov.cn/atom.xml" title="weiwenhao"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/weiwenhao" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">编写具有描述性的 RESTful API (四): 通知系统</h1><div class="post-info">2019年3月27日</div><div class="post-content"><p>上一节讲到了用户行为，由用户行为自然的便引出了通知系统。当用户喜欢了一篇帖子，那么该帖子的作者应该收到一条提醒。</p>
<p>laravel 提供了一套 <a href="https://learnku.com/docs/laravel/5.8/notifications/3921" target="_blank" rel="noopener">Notification</a> 组件，用于处理通知，其支持通过多种频道发送通知，包括邮件、短信 、通知还能存储到数据库（站内信）以便后续在 Web 页面中显示，<strong>本节将重点放在站内信。</strong></p>
<p>laravel 为我们摆平了通知的推送问题，但是还有一个问题，即通知（数据库）的存储问题需要我们处理。通知的存储通常有两种做法。</p>
<ul>
<li>将通知的主体内容与部分附加内容一同冗余存储到数据库中，即 laravel 的默认形式。</li>
<li>将通知的主体内容的主键与其附加内容的主键 既 id 存储到数据库中。</li>
</ul>
<p>前者的好处是较小的查询压力，且数据具有持久性，不会因为被删帖等问题而影响到通知内容。缺点则是占用存储空间，且缺乏灵活性，后者则反之。</p>
<p>源码中选择了前者，既默认形式。</p>
<h2 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h2><p>通过抽象可以得到，一条通知由三部分组成 <strong>行为的触发者 trigger 、行为主体(可能携带 内容) target 、需要通知的用户 notifiable</strong></p>
<p>此处最让人疑惑的应该是 行为的主体，根据实际需求稍微图解一下。</p>
<p><img src="https://cdn.learnku.com/uploads/images/201903/27/10960/gyqloOm9E0.png!large" alt></p>
<p>已 「Comment Post」为例，在简书中其实际的表现行为如下</p>
<p><img src="https://cdn.learnku.com/uploads/images/201903/27/10960/Vc0YhVnK7v.png!large" alt></p>
<p>根据上面的分析 notifications 表中的 data 需要冗余如下数据，<strong>可以根据运营的实际需求调整</strong>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toArray</span><span class="params">($notifiable)</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   $data = [</span><br><span class="line">     <span class="string">'trigger'</span> =&gt; [</span><br><span class="line">       <span class="string">'id'</span> =&gt; <span class="number">1</span>, <span class="comment">// default type users</span></span><br><span class="line">       <span class="string">'type'</span> =&gt; <span class="string">'users'</span>,</span><br><span class="line">       <span class="string">'nickname'</span> =&gt; <span class="string">'nickname'</span>,</span><br><span class="line">       <span class="string">'avatar'</span> =&gt; <span class="string">'xxx'</span>,</span><br><span class="line">     ],</span><br><span class="line">     <span class="string">'target'</span> =&gt; [</span><br><span class="line">       <span class="string">'id'</span> =&gt; <span class="number">12</span>,</span><br><span class="line">       <span class="string">'type'</span> =&gt; <span class="string">'posts'</span>,</span><br><span class="line">       <span class="string">'text'</span> =&gt; <span class="string">'xxx'</span>,</span><br><span class="line">     ],</span><br><span class="line">     <span class="string">'content'</span> =&gt; [</span><br><span class="line">       <span class="string">'id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">       <span class="string">'type'</span> =&gt; <span class="string">'comment'</span>,</span><br><span class="line">       <span class="string">'text'</span> =&gt; <span class="string">'xxx'</span>,</span><br><span class="line">       <span class="string">'call_user'</span> =&gt; [</span><br><span class="line">         <span class="string">'id'</span> =&gt; <span class="string">'xxx'</span>,</span><br><span class="line">         <span class="string">'nickname'</span> =&gt; <span class="string">'xxx'</span></span><br><span class="line">       ]</span><br><span class="line">     ]</span><br><span class="line">   ];</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">return</span> $data;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建通知"><a href="#创建通知" class="headerlink" title="创建通知"></a>创建通知</h2><p>已上一次的 「Like Post」 行为为例，当用户点赞文章后，需要给文章的作者发送一条通知。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PostLikerObserver</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> PostLiker $postLiker</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">created</span><span class="params">(PostLiker $postLiker)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// notify App\Notifications\LikePost</span></span><br><span class="line">  User::findOrFail($postLiker-&gt;post-&gt;user_id)</span><br><span class="line">    -&gt;notify(<span class="keyword">new</span> LikePost($user, $postLiker-&gt;post));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LikerPost.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Notifications</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LikePost</span> <span class="keyword">extends</span> <span class="title">Notification</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">Queueable</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">private</span> $post;</span><br><span class="line">    <span class="keyword">private</span> $trigger;</span><br><span class="line">    <span class="keyword">private</span> $target;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(User $trigger, Post $target)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;trigger = $trigger;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;target = $target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toArray</span><span class="params">($notifiable)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $data = [</span><br><span class="line">            <span class="string">'trigger'</span> =&gt; [</span><br><span class="line">                <span class="string">'id'</span> =&gt; <span class="keyword">$this</span>-&gt;trigger-&gt;id,</span><br><span class="line">                <span class="string">'type'</span> =&gt; <span class="keyword">$this</span>-&gt;trigger-&gt;getTable(),</span><br><span class="line">                <span class="string">'nickname'</span> =&gt; <span class="keyword">$this</span>-&gt;trigger-&gt;nickname,</span><br><span class="line">                <span class="string">'avatar'</span> =&gt; <span class="keyword">$this</span>-&gt;trigger-&gt;avatar,</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">'target'</span> =&gt; [</span><br><span class="line">                <span class="string">'id'</span> =&gt; <span class="keyword">$this</span>-&gt;target-&gt;id,</span><br><span class="line">                <span class="string">'type'</span> =&gt; <span class="keyword">$this</span>-&gt;target-&gt;getTable(),</span><br><span class="line">                <span class="string">'text'</span> =&gt; <span class="keyword">$this</span>-&gt;target-&gt;title,</span><br><span class="line">            ]</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就成功建立了一条 Notification ,  类似「Comment Post」等用户行为依旧可以按照这种思路完成。无非「Comment Post」需要在其 data 中添加 content 而已，这里就不做展示了。</p>
<p>这里需要提一下代码优化，通过上面的「数据分析」，我们已经把通知抽象为 trigger / target / content ，因此并不需要再每种用户行为都编写一堆  重复的构造方法，toArray 等方法。</p>
<p>完全可以编写一个 Notification 基类来编写上面的大部分代码，从而减少重复的代码。</p>
<blockquote>
<p>相关优化已经完成，欢迎参考源码。</p>
</blockquote>
<h2 id="通知的另一种存储方式"><a href="#通知的另一种存储方式" class="headerlink" title="通知的另一种存储方式"></a>通知的另一种存储方式</h2><p>这里稍微提一下另外一种形式的通知存储，即上文中提到的非冗余形式。不过该方式需要修改 notifications 表的默认表结构。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Schema::create(<span class="string">'notifications'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(Blueprint $table)</span> </span>&#123;</span><br><span class="line">  $table-&gt;uuid(<span class="string">'id'</span>)-&gt;primary();</span><br><span class="line">  $table-&gt;string(<span class="string">'type'</span>);</span><br><span class="line">  $table-&gt;morphs(<span class="string">'notifiable'</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// $table-&gt;json('data')-&gt;nullable()-&gt;comment('target/content/trigger');</span></span><br><span class="line">  $table-&gt;morphs(<span class="string">'triggerable'</span>)-&gt;nullable();</span><br><span class="line">  $table-&gt;morphs(<span class="string">'targetable'</span>)-&gt;nullable()</span><br><span class="line">  $table-&gt;morphs(<span class="string">'contentable'</span>)-&gt;nullable();</span><br><span class="line">  </span><br><span class="line">  $table-&gt;timestamp(<span class="string">'read_at'</span>)-&gt;nullable();</span><br><span class="line">  $table-&gt;timestamps();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>通过表结构相信你已经一目了然。万变不离其宗，<strong>我们始终都是在围绕着 trigger / target / content 转圈圈。</strong></p>
<blockquote>
<p>当然如果你了解 「 MySQL 生成列 」的话，完全可以写出下叙语句，将通知从冗余形式平滑过渡到到非冗余形式。</p>
<p><code>$table-&gt;string(&#39;targetable_id&#39;)-&gt;virtualAs(&#39;data-&gt;&gt;&quot;$.target.id&quot;&#39;)-&gt;index();</code></p>
</blockquote>
<p>有了这样的表结构，关联关系走起来，需要的数据如 文章的 点赞量 / 阅读量 等等都能够得到，这里就不详细描述代码编写了。后续简书的<strong>用户动态模块</strong>会再次运用这种非冗余结构的编码，到时再深入讲解相关的细节。</p>
<h2 id="通知压缩"><a href="#通知压缩" class="headerlink" title="通知压缩"></a>通知压缩</h2><p>我们的通知采用了冗余形式存储，所以数据存储空间优化是必须考虑的一个点。尤其是在点赞这类通知中，对数据的浪费是非常巨大的。</p>
<p>因此可以通过类似下面这样的方式压缩<strong>未读通知</strong>。</p>
<p><img src="https://cdn.learnku.com/uploads/images/201903/27/10960/pOemJX9z1m.png!large" alt></p>
<blockquote>
<p>当然，如果你选择非冗余形式存储通知数据，那么将难以进行数据压缩。</p>
</blockquote>
<p>Notification 组件提供了通知后 <a href="https://learnku.com/docs/laravel/5.8/notifications/3921#notification-events" target="_blank" rel="noopener">事件</a> ,所以相应的逻辑将会在该事件的监听者中完成。逻辑比较简单，直接看编码吧</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># App\Listeners\CompressNotification</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CompressNotification</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">(NotificationSent $event)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $channel = $event-&gt;channel;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($channel !== DatabaseChannel::class) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $currentNotification = $event-&gt;response;</span><br><span class="line">        <span class="keyword">if</span> (!in_array($currentNotification-&gt;type, [<span class="string">'like_post'</span>, <span class="string">'like_comment'</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $notifiable = $event-&gt;notifiable;</span><br><span class="line">      </span><br><span class="line">      	<span class="comment">// 查找相同 target 的上一条通知</span></span><br><span class="line">        $previousNotification = $notifiable-&gt;unreadNotifications()</span><br><span class="line">            -&gt;where(<span class="string">'data-&gt;target-&gt;type'</span>, $currentNotification-&gt;data[<span class="string">'target'</span>][<span class="string">'type'</span>])</span><br><span class="line">            -&gt;where(<span class="string">'data-&gt;target-&gt;id'</span>, $currentNotification-&gt;data[<span class="string">'target'</span>][<span class="string">'id'</span>])</span><br><span class="line">            -&gt;where(<span class="string">'id'</span>, <span class="string">'&lt;&gt;'</span>, $currentNotification-&gt;id)</span><br><span class="line">            -&gt;first();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($previousNotification) &#123;</span><br><span class="line">            $compressCount = $previousNotification-&gt;data[<span class="string">'compress_count'</span>] ?? <span class="number">1</span>;</span><br><span class="line">            $triggers = $previousNotification-&gt;data[<span class="string">'triggers'</span>] ?? [$previousNotification-&gt;data[<span class="string">'trigger'</span>]];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            $compressCount += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 最多存储三个触发者</span></span><br><span class="line">            <span class="keyword">if</span> (count($triggers) &lt; <span class="number">3</span>) &#123;</span><br><span class="line">                $triggers[] = $currentNotification-&gt;data[<span class="string">'trigger'</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $previousNotification-&gt;delete();</span><br><span class="line"></span><br><span class="line">            $data = $currentNotification-&gt;data;</span><br><span class="line">            $data[<span class="string">'compress_count'</span>] = $compressCount;</span><br><span class="line">            $data[<span class="string">'triggers'</span>] = $triggers;</span><br><span class="line">            <span class="keyword">unset</span>($data[<span class="string">'trigger'</span>]);</span><br><span class="line">          </span><br><span class="line">            $currentNotification-&gt;data = $data;</span><br><span class="line">            $currentNotification-&gt;save();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>压缩后的通知的 data 的 trigger Object 变成了 triggers Array ，并且增加了 <code>compress_count</code> 用来记录压缩条数，前端可以通过该字段来判断通知是否被压缩过。</p>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><ul>
<li>相应的 API 如通知列表，标记为已读等已经完成，欢迎参考源码。</li>
<li>通常会有一个与通知类似<strong>性质</strong>的功能，称为消息，或者说私信/聊天等。该功能依旧可以使用 Notification 来完成，因为其也是由 <strong>行为的触发者 trigger 、行为主体(可能携带 内容) target 、需要通知的用户 notifiable </strong> 构成。但是从解耦的角度来看，将其单独成一个 「Chat 模块」，且消息提醒依旧使用 「Notification」 来完成会是更好的选择。</li>
<li>通常会有一个与通知类似<strong>结构</strong>的功能，称为用户动态，或者说用户日志。上文中有提到该功能，后续会完成该功能。</li>
<li>未读消息数在 users 表中冗余 <code>unread_notification_count</code> ，而不是进行实时计数。</li>
</ul>
<h2 id="相关"><a href="#相关" class="headerlink" title="相关"></a>相关</h2><ul>
<li>Api document <a href="https://documenter.getpostman.com/view/1500624/S17nTVKL" target="_blank" rel="noopener">postman</a></li>
<li>线上调试工具 <a href="http://community.eienao.com/telescope" target="_blank" rel="noopener">telescope</a></li>
<li>本节源码 <a href="https://github.com/weiwenhao/community-api/tree/0.4.0-alpha" target="_blank" rel="noopener">weiwenhao/community-api</a></li>
<li>Api Tool <a href="https://github.com/weiwenhao/tree-ql" target="_blank" rel="noopener">weiwenhao/tree-ql</a></li>
<li>上一节 <a href="https://learnku.com/articles/25824" target="_blank" rel="noopener">编写具有描述性的 RESTful API (三): 用户行为</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/posts/秒杀系统的设计.html" class="prev">PREV</a><a href="/posts/编写具有描述性的 RESTful API (三): 用户行为.html" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'maxwei';
var disqus_identifier = 'posts/编写具有描述性的 RESTful API (四): 通知系统.html';
var disqus_title = '编写具有描述性的 RESTful API (四): 通知系统';
var disqus_url = 'http://beian.miit.gov.cn/posts/编写具有描述性的 RESTful API (四): 通知系统.html';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//maxwei.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 - 2020 <a href="http://beian.miit.gov.cn">粤ICP备18153286</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-113144905-1",'auto');ga('send','pageview');</script></body></html>